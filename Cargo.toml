[package]
name = "kataglyphis_rustprojecttemplate"
version = "0.1.0"
edition = "2024"

[lib]
name = "kataglyphis_rustprojecttemplate"
crate-type = ["cdylib", "staticlib"]

[features]
# CLI-only by default to avoid GTK/GStreamer on Windows.
default = []
gui = ["dep:gstreamer", "dep:gstreamer-video", "dep:glib"]
gui_unix = ["gui", "dep:gtk"]
gui_linux = ["gui_windows"]
gui_windows = [
	"gui",
	"dep:gstreamer-app",
	"dep:winit",
	"dep:wgpu",
	"dep:pollster",
	"dep:bytemuck",
	"dep:egui",
	"dep:egui-winit",
	"dep:egui-wgpu",
]

[dependencies]
flutter_rust_bridge = "=2.11.1"
anyhow = "1"
log = "0.4"
env_logger = "0.11.8"
clap = { version = "4", features = ["derive"] }
gtk = { version = "0.10", package = "gtk4", features = ["v4_10"], optional = true }
gstreamer = { version = "0.24.4", optional = true }
gstreamer-video = { version = "0.24.4", optional = true }
glib = { version = "0.21.5", optional = true }
gstreamer-app = { version = "0.24.4", optional = true }
winit = { version = "0.30", optional = true }
wgpu = { version = "27.0", optional = true }
pollster = { version = "0.4", optional = true }
bytemuck = { version = "1.24", features = ["derive"], optional = true }
egui = { version = "0.33", optional = true }
egui-winit = { version = "0.33", optional = true }
egui-wgpu = { version = "0.33", optional = true }

# Tokio on wasm only supports a small subset of features.
[target.'cfg(not(target_arch = "wasm32"))'.dependencies]
tokio = { version = "1", features = ["fs", "macros", "rt-multi-thread", "time"] }

[target.'cfg(target_arch = "wasm32")'.dependencies]
tokio = { version = "1", default-features = false, features = ["macros", "rt", "time", "sync"] }

[lints.rust]
# `flutter_rust_bridge::frb` uses `cfg(frb_expand)` internally; declare it so Rust's
# `unexpected_cfgs` lint doesn't warn.
unexpected_cfgs = { level = "warn", check-cfg = ['cfg(frb_expand)'] }

[dev-dependencies]
assert_cmd = "2"
predicates = "3"
tempfile = "3"
